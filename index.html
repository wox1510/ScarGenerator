<!DOCTYPE html>
<html>
<body>

<h1>Click the button to get a card.</h1>
<div>
<button type="button" style="height:50px;width:100px" id=cardButton>Random Discord Card!</button>
<button type="button" style="height:50px;width:100px" id=kamigawaButton>Kamigawa Pack!</button>
<button type="button" style="height:50px;width:100px" id=commanderButton>Commander Deck!</button><br>
<table id="cardTable" border="1">
<br>
<table id="boosterTable" border="1"><br>
<table id="chooseTable" border="1"><br>
<table id="libraryTable" border="1"><br>
<table id="handTable" border="1"><br>
<table id="battlefieldTable" border="1"><br>
<table id="graveyardTable" border="1"><br>
<table id="exileTable" border="1"><br>
<table id="commanderTable" border="1"><br>
<button type="button" id=restoreButton>Restore</button><br>

<script>
let cards = []
let cardId = 1;
let kamigawaCards = []
let kamigawaCardId = 1;
let commanderCards = []
let cardBackImage = "https://backs.scryfall.io/large/2/2/222b7a3b-2321-4d4c-af19-19338b134971.jpg?1677416389";

function isDoubleFace(card) {
  return (card.content.card_faces && card.content.layout != "flip" && card.content.layout != "split" && card.content.layout != "adventure")
}

function drawTables() {
  drawCardsTable();
  drawBoosterTable();
  drawChooseTable();
  drawLibraryTable();
  drawHandTable();
  drawBattlefieldTable();
  drawGraveyardTable();
  drawExileTable();
  drawCommanderTable();
}

function drawCardsTable()
{
  var table = document.getElementById('cardTable');
  var tableBody = document.createElement('tbody');
  table.appendChild(tableBody);
  cards.filter(card => (card.status != "Gone")).forEach(function(card, i) {
	var headerRow
	var cardRow
	if (i % 5 == 0) {
	  headerRow = document.createElement('tr');
	  cardRow = document.createElement('tr');
	  footerRow = document.createElement('tr');
	} else {
	  headerRow = table.rows[Math.floor(i/5)*3]
	  cardRow = table.rows[Math.floor(i/5)*3 + 1]
	  footerRow = table.rows[Math.floor(i/5)*3 + 2]
	}
	 var Header = document.createElement("th");
     Header.textContent =  card.id;
	 
	  var cardDiv = document.createElement('td');
	 var cardImage = document.createElement('img');
	 
	 var cardImageLink
	 if (isDoubleFace(card)) {
	   if (card.status == "ShownBack") {
	    cardImageLink = card.content.card_faces[1].image_uris.normal;
	   } else {
	    cardImageLink = card.content.card_faces[0].image_uris.normal;
		}
	 } else {
	   cardImageLink = card.content.image_uris.normal;
	 }
	 
	 cardImage.src =  (card.status == "Hidden") ? cardBackImage : cardImageLink;
	 cardImage.width = 300;
	 cardImage.height = 450;
	 cardDiv.appendChild(cardImage);
	 
	 var footerDiv = document.createElement('td');
	 footerDiv.setAttribute('style','text-align :center;');
	var revealButton = document.createElement('button');
  	revealButton.data =  "Reveal";
  	revealButton.innerHTML = "Reveal";
	revealButton.size="large";
  	revealButton.onclick = function (){
	  cards.find(cardRevealed => cardRevealed.id == card.id).status = "Shown"
  	  drawTables();
	};
	revealButton.setAttribute('style','height:50px;width:100px;');
	
	var goneButton = document.createElement('button');
  	goneButton.data =  "Gone";
  	goneButton.innerHTML = "Gone";
	goneButton.size="large";
  	goneButton.onclick = function (){
	  cards.find(cardGone => cardGone.id == card.id).status = "Gone"
  	  drawTables();
	};
	goneButton.setAttribute('style','height:50px;width:100px;');
	
	var showBackButton = document.createElement('button');
  	showBackButton.data =  "Show Back";
  	showBackButton.innerHTML = "Show Back";
	showBackButton.size="large";
  	showBackButton.onclick = function (){
	  cards.find(cardShowBack => cardShowBack.id == card.id).status = "ShownBack"
  	  drawTables();
	};
	showBackButton.setAttribute('style','height:50px;width:100px;');
	
	var showFrontButton = document.createElement('button');
  	showFrontButton.data =  "Show Front";
  	showFrontButton.innerHTML = "Show Front";
	showFrontButton.size="large";
  	showFrontButton.onclick = function (){
	  cards.find(cardShowBack => cardShowBack.id == card.id).status = "Shown"
  	  drawTables();
	};
	showFrontButton.setAttribute('style','height:50px;width:100px;');
	
	if (card.status == "Hidden") {
	  footerDiv.appendChild(revealButton);
	} else if (card.status == "Shown") {
	  if (card.content.card_faces) {
	   footerDiv.appendChild(showBackButton);
	  } 
	  footerDiv.appendChild(goneButton);
	} else if (card.status == "ShownBack") {
	  footerDiv.appendChild(showFrontButton);
	  footerDiv.appendChild(goneButton);
	}
	 
	
	 headerRow.appendChild(Header);
	 cardRow.appendChild(cardDiv);
	 footerRow.appendChild(footerDiv);
	 
  
	 
     tableBody.appendChild(headerRow);
	 tableBody.appendChild(cardRow);
	 tableBody.appendChild(footerRow);

 
	 if (table.tBodies[0]) {
	  table.replaceChild(tableBody, table.tBodies[0]);
	 } else {
	  table.appendChild(tableBody);
	 }
  });
  if (cards.filter(card => (card.status != "Gone")).length == 0) {
    table.replaceChild(tableBody, table.tBodies[0]);
  }
  
}

function drawBoosterTable()
{
  var table = document.getElementById('boosterTable');
  var tableBody = document.createElement('tbody');
  table.appendChild(tableBody);
  
  topRow = document.createElement('tr');
  var topHeader = document.createElement("th");
  topHeader.textContent =  "There are " + kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Booster")).length + " cards in the Booster Zone. ";
  topRow.appendChild(topHeader);
  
	var showFourButton = document.createElement('button');
	showFourButton.data =  "Show Four";
	showFourButton.innerHTML = "Show Four";
	showFourButton.size="large";
	showFourButton.onclick = function (){
	  if (kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Booster")).length > 4) {
		  boosterCards = kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Booster"))
		  chooseCardId = boosterCards[Math.floor(Math.random() * boosterCards.length)].id;
		  kamigawaCards.find(card => (card.id == chooseCardId)).zone = "Choose"
		  
		  boosterCards = kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Booster"))
		  chooseCardId = boosterCards[Math.floor(Math.random() * boosterCards.length)].id;
		  kamigawaCards.find(card => (card.id == chooseCardId)).zone = "Choose"
		  
		  boosterCards = kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Booster"))
		  chooseCardId = boosterCards[Math.floor(Math.random() * boosterCards.length)].id;
		  kamigawaCards.find(card => (card.id == chooseCardId)).zone = "Choose"
		  
		  boosterCards = kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Booster"))
		  chooseCardId = boosterCards[Math.floor(Math.random() * boosterCards.length)].id;
		  kamigawaCards.find(card => (card.id == chooseCardId)).zone = "Choose"
	  } else {
	      kamigawaCards.forEach(function(card) {  
			card.zone = "Choose";
		  });
	  }
	  
	  drawTables();
	};
	showFourButton.setAttribute('style','height:50px;width:100px;'); 
	
	topRow.appendChild(showFourButton);
 
  tableBody.appendChild(topRow);
  
 if (table.tBodies[0]) {
  table.replaceChild(tableBody, table.tBodies[0]);
 } else {
  table.appendChild(tableBody);
 }
}

function drawChooseTable()
{
  var table = document.getElementById('chooseTable');
  var tableBody = document.createElement('tbody');
  table.appendChild(tableBody);
  
  kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Choose")).forEach(function(card, i) {
	var headerRow
	var cardRow
	if (i % 5 == 0) {
	  headerRow = document.createElement('tr');
	  cardRow = document.createElement('tr');
	  footerRow = document.createElement('tr');
	} else {
	  headerRow = table.rows[Math.floor(i/5)*3]
	  cardRow = table.rows[Math.floor(i/5)*3 + 1]
	  footerRow = table.rows[Math.floor(i/5)*3 + 2]
	}
	 var Header = document.createElement("th");
     Header.textContent =  "Choose Zone: " + card.id;
	 
	  var cardDiv = document.createElement('td');
	 var cardImage = document.createElement('img');
	 
	 var cardImageLink
	 if (isDoubleFace(card)) {
	   if (card.status == "ShownBack") {
	    cardImageLink = card.content.card_faces[1].image_uris.normal;
	   } else {
	    cardImageLink = card.content.card_faces[0].image_uris.normal;
		}
	 } else {
	   cardImageLink = card.content.image_uris.normal;
	 }
	 
	 cardImage.src =  (card.status == "Hidden") ? cardBackImage : cardImageLink;
	 cardImage.width = 300;
	 cardImage.height = 450;
	 cardDiv.appendChild(cardImage);
	 
	 var footerDiv = document.createElement('td');
	 footerDiv.setAttribute('style','text-align :center;');
	var revealButton = document.createElement('button');
  	revealButton.data =  "Reveal";
  	revealButton.innerHTML = "Reveal";
	revealButton.size="large";
  	revealButton.onclick = function (){
	  kamigawaCards.find(cardRevealed => cardRevealed.id == card.id).status = "Shown"
  	  drawTables();
	};
	revealButton.setAttribute('style','height:50px;width:100px;');
	
	var handButton = document.createElement('button');
  	handButton.data =  "Hand";
  	handButton.innerHTML = "Hand";
	handButton.size="large";
  	handButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Hand"
  	  drawTables();
	};
	handButton.setAttribute('style','height:50px;width:100px;');
	
	var graveyardButton = document.createElement('button');
  	graveyardButton.data =  "Graveyard";
  	graveyardButton.innerHTML = "Graveyard";
	graveyardButton.size="large";
  	graveyardButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Graveyard"
  	  drawTables();
	};
	graveyardButton.setAttribute('style','height:50px;width:100px;');
	
	var showBackButton = document.createElement('button');
  	showBackButton.data =  "Show Back";
  	showBackButton.innerHTML = "Show Back";
	showBackButton.size="large";
  	showBackButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "ShownBack"
  	  drawTables();
	};
	showBackButton.setAttribute('style','height:50px;width:100px;');
	
	var showFrontButton = document.createElement('button');
  	showFrontButton.data =  "Show Front";
  	showFrontButton.innerHTML = "Show Front";
	showFrontButton.size="large";
  	showFrontButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "Shown"
  	  drawTables();
	};
	showFrontButton.setAttribute('style','height:50px;width:100px;');
	
	if (card.status == "Hidden") {
	  footerDiv.appendChild(revealButton);
	} else if (card.status == "Shown") {
	  if (card.content.card_faces) {
	   footerDiv.appendChild(showBackButton);
	  } 
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(graveyardButton);
	} else if (card.status == "ShownBack") {
	  footerDiv.appendChild(showFrontButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(graveyardButton);
	}
	 
	
	 headerRow.appendChild(Header);
	 cardRow.appendChild(cardDiv);
	 footerRow.appendChild(footerDiv);
	 
  
	 
     tableBody.appendChild(headerRow);
	 tableBody.appendChild(cardRow);
	 tableBody.appendChild(footerRow);

 
	 if (table.tBodies[0]) {
	  table.replaceChild(tableBody, table.tBodies[0]);
	 } else {
	  table.appendChild(tableBody);
	 }
  });
  if (cards.filter(card => (card.status != "Gone")).length == 0) {
    table.replaceChild(tableBody, table.tBodies[0]);
  }
  
}

function drawHandTable()
{
  var table = document.getElementById('handTable');
  var tableBody = document.createElement('tbody');
  table.appendChild(tableBody);
  
  kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Hand")).forEach(function(card, i) {
	var headerRow
	var cardRow
	if (i % 5 == 0) {
	  headerRow = document.createElement('tr');
	  cardRow = document.createElement('tr');
	  footerRow = document.createElement('tr');
	} else {
	  headerRow = table.rows[Math.floor(i/5)*3]
	  cardRow = table.rows[Math.floor(i/5)*3 + 1]
	  footerRow = table.rows[Math.floor(i/5)*3 + 2]
	}
	 var Header = document.createElement("th");
     Header.textContent =  "Hand: " + card.id;
	 
	  var cardDiv = document.createElement('td');
	 var cardImage = document.createElement('img');
	 
	 var cardImageLink
	 if (isDoubleFace(card)) {
	   if (card.status == "ShownBack") {
	    cardImageLink = card.content.card_faces[1].image_uris.normal;
	   } else {
	    cardImageLink = card.content.card_faces[0].image_uris.normal;
		}
	 } else {
	   cardImageLink = card.content.image_uris.normal;
	 }
	 
	 cardImage.src =  (card.status == "Hidden") ? cardBackImage : cardImageLink;
	 cardImage.width = 300;
	 cardImage.height = 450;
	 cardDiv.appendChild(cardImage);
	 
	 var footerDiv = document.createElement('td');
	 footerDiv.setAttribute('style','text-align :center;');
	var revealButton = document.createElement('button');
  	revealButton.data =  "Reveal";
  	revealButton.innerHTML = "Reveal";
	revealButton.size="large";
  	revealButton.onclick = function (){
	  kamigawaCards.find(cardRevealed => cardRevealed.id == card.id).status = "Shown"
  	  drawTables();
	};
	revealButton.setAttribute('style','height:50px;width:100px;');
	
	var libraryButton = document.createElement('button');
  	libraryButton.data =  "Library";
  	libraryButton.innerHTML = "Library";
	libraryButton.size="large";
  	libraryButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Library"
  	  drawTables();
	};
	libraryButton.setAttribute('style','height:50px;width:100px;');
	
	var handButton = document.createElement('button');
  	handButton.data =  "Hand";
  	handButton.innerHTML = "Hand";
	handButton.size="large";
  	handButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Hand"
  	  drawTables();
	};
	handButton.setAttribute('style','height:50px;width:100px;');
	
	var battlefieldButton = document.createElement('button');
  	battlefieldButton.data =  "Battlefield";
  	battlefieldButton.innerHTML = "Battlefield";
	battlefieldButton.size="large";
  	battlefieldButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Battlefield"
  	  drawTables();
	};
	battlefieldButton.setAttribute('style','height:50px;width:100px;');
	
	var graveyardButton = document.createElement('button');
  	graveyardButton.data =  "Graveyard";
  	graveyardButton.innerHTML = "Graveyard";
	graveyardButton.size="large";
  	graveyardButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Graveyard"
  	  drawTables();
	};
	graveyardButton.setAttribute('style','height:50px;width:100px;');
	
	var exileButton = document.createElement('button');
  	exileButton.data =  "Exile";
  	exileButton.innerHTML = "Exile";
	exileButton.size="large";
  	exileButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Exile"
  	  drawTables();
	};
	exileButton.setAttribute('style','height:50px;width:100px;');
	
	var showBackButton = document.createElement('button');
  	showBackButton.data =  "Show Back";
  	showBackButton.innerHTML = "Show Back";
	showBackButton.size="large";
  	showBackButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "ShownBack"
  	  drawTables();
	};
	showBackButton.setAttribute('style','height:50px;width:100px;');
	
	var showFrontButton = document.createElement('button');
  	showFrontButton.data =  "Show Front";
  	showFrontButton.innerHTML = "Show Front";
	showFrontButton.size="large";
  	showFrontButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "Shown"
  	  drawTables();
	};
	showFrontButton.setAttribute('style','height:50px;width:100px;');
	
	if (card.status == "Hidden") {
	  footerDiv.appendChild(revealButton);
	} else if (card.status == "Shown") {
	  if (card.content.card_faces) {
	   footerDiv.appendChild(showBackButton);
	  } 
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	} else if (card.status == "ShownBack") {
	  footerDiv.appendChild(showFrontButton);
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	}
	 
	
	 headerRow.appendChild(Header);
	 cardRow.appendChild(cardDiv);
	 footerRow.appendChild(footerDiv);
	 
  
	 
     tableBody.appendChild(headerRow);
	 tableBody.appendChild(cardRow);
	 tableBody.appendChild(footerRow);

 
	 if (table.tBodies[0]) {
	  table.replaceChild(tableBody, table.tBodies[0]);
	 } else {
	  table.appendChild(tableBody);
	 }
  });
  if (cards.filter(card => (card.status != "Gone")).length == 0) {
    table.replaceChild(tableBody, table.tBodies[0]);
  }
  
}

function drawGraveyardTable()
{
  var table = document.getElementById('graveyardTable');
  var tableBody = document.createElement('tbody');
  table.appendChild(tableBody);
  
  kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Graveyard")).forEach(function(card, i) {
	var headerRow
	var cardRow
	if (i % 5 == 0) {
	  headerRow = document.createElement('tr');
	  cardRow = document.createElement('tr');
	  footerRow = document.createElement('tr');
	} else {
	  headerRow = table.rows[Math.floor(i/5)*3]
	  cardRow = table.rows[Math.floor(i/5)*3 + 1]
	  footerRow = table.rows[Math.floor(i/5)*3 + 2]
	}
	 var Header = document.createElement("th");
     Header.textContent =  "Graveyard: " + card.id;
	 
	  var cardDiv = document.createElement('td');
	 var cardImage = document.createElement('img');
	 
	 var cardImageLink
	 if (isDoubleFace(card)) {
	   if (card.status == "ShownBack") {
	    cardImageLink = card.content.card_faces[1].image_uris.normal;
	   } else {
	    cardImageLink = card.content.card_faces[0].image_uris.normal;
		}
	 } else {
	   cardImageLink = card.content.image_uris.normal;
	 }
	 
	 cardImage.src =  (card.status == "Hidden") ? cardBackImage : cardImageLink;
	 cardImage.width = 300;
	 cardImage.height = 450;
	 cardDiv.appendChild(cardImage);
	 
	 var footerDiv = document.createElement('td');
	 footerDiv.setAttribute('style','text-align :center;');
	var revealButton = document.createElement('button');
  	revealButton.data =  "Reveal";
  	revealButton.innerHTML = "Reveal";
	revealButton.size="large";
  	revealButton.onclick = function (){
	  kamigawaCards.find(cardRevealed => cardRevealed.id == card.id).status = "Shown"
  	  drawTables();
	};
	revealButton.setAttribute('style','height:50px;width:100px;');
	
	var libraryButton = document.createElement('button');
  	libraryButton.data =  "Library";
  	libraryButton.innerHTML = "Library";
	libraryButton.size="large";
  	libraryButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Library"
  	  drawTables();
	};
	libraryButton.setAttribute('style','height:50px;width:100px;');
	
	var handButton = document.createElement('button');
  	handButton.data =  "Hand";
  	handButton.innerHTML = "Hand";
	handButton.size="large";
  	handButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Hand"
  	  drawTables();
	};
	handButton.setAttribute('style','height:50px;width:100px;');
	
	var battlefieldButton = document.createElement('button');
  	battlefieldButton.data =  "Battlefield";
  	battlefieldButton.innerHTML = "Battlefield";
	battlefieldButton.size="large";
  	battlefieldButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Battlefield"
  	  drawTables();
	};
	battlefieldButton.setAttribute('style','height:50px;width:100px;');
	
	var graveyardButton = document.createElement('button');
  	graveyardButton.data =  "Graveyard";
  	graveyardButton.innerHTML = "Graveyard";
	graveyardButton.size="large";
  	graveyardButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Graveyard"
  	  drawTables();
	};
	graveyardButton.setAttribute('style','height:50px;width:100px;');
	
	var exileButton = document.createElement('button');
  	exileButton.data =  "Exile";
  	exileButton.innerHTML = "Exile";
	exileButton.size="large";
  	exileButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Exile"
  	  drawTables();
	};
	exileButton.setAttribute('style','height:50px;width:100px;');
	
	var showBackButton = document.createElement('button');
  	showBackButton.data =  "Show Back";
  	showBackButton.innerHTML = "Show Back";
	showBackButton.size="large";
  	showBackButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "ShownBack"
  	  drawTables();
	};
	showBackButton.setAttribute('style','height:50px;width:100px;');
	
	var showFrontButton = document.createElement('button');
  	showFrontButton.data =  "Show Front";
  	showFrontButton.innerHTML = "Show Front";
	showFrontButton.size="large";
  	showFrontButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "Shown"
  	  drawTables();
	};
	showFrontButton.setAttribute('style','height:50px;width:100px;');
	
	if (card.status == "Hidden") {
	  footerDiv.appendChild(revealButton);
	} else if (card.status == "Shown") {
	  if (card.content.card_faces) {
	   footerDiv.appendChild(showBackButton);
	  } 
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	} else if (card.status == "ShownBack") {
	  footerDiv.appendChild(showFrontButton);
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	}
	 
	
	 headerRow.appendChild(Header);
	 cardRow.appendChild(cardDiv);
	 footerRow.appendChild(footerDiv);
	 
  
	 
     tableBody.appendChild(headerRow);
	 tableBody.appendChild(cardRow);
	 tableBody.appendChild(footerRow);

 
	 if (table.tBodies[0]) {
	  table.replaceChild(tableBody, table.tBodies[0]);
	 } else {
	  table.appendChild(tableBody);
	 }
  });
  if (cards.filter(card => (card.status != "Gone")).length == 0) {
    table.replaceChild(tableBody, table.tBodies[0]);
  }
  
}

function drawBattlefieldTable()
{
  var table = document.getElementById('battlefieldTable');
  var tableBody = document.createElement('tbody');
  table.appendChild(tableBody);
  
  kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Battlefield")).forEach(function(card, i) {
	var headerRow
	var cardRow
	if (i % 5 == 0) {
	  headerRow = document.createElement('tr');
	  cardRow = document.createElement('tr');
	  footerRow = document.createElement('tr');
	} else {
	  headerRow = table.rows[Math.floor(i/5)*3]
	  cardRow = table.rows[Math.floor(i/5)*3 + 1]
	  footerRow = table.rows[Math.floor(i/5)*3 + 2]
	}
	 var Header = document.createElement("th");
     Header.textContent =  "Battlefield: " + card.id;
	 
	  var cardDiv = document.createElement('td');
	 var cardImage = document.createElement('img');
	 
	 var cardImageLink
	 if (isDoubleFace(card)) {
	   if (card.status == "ShownBack") {
	    cardImageLink = card.content.card_faces[1].image_uris.normal;
	   } else {
	    cardImageLink = card.content.card_faces[0].image_uris.normal;
		}
	 } else {
	   cardImageLink = card.content.image_uris.normal;
	 }
	 
	 cardImage.src =  (card.status == "Hidden") ? cardBackImage : cardImageLink;
	 cardImage.width = 300;
	 cardImage.height = 450;
	 cardDiv.appendChild(cardImage);
	 
	 var footerDiv = document.createElement('td');
	 footerDiv.setAttribute('style','text-align :center;');
	var revealButton = document.createElement('button');
  	revealButton.data =  "Reveal";
  	revealButton.innerHTML = "Reveal";
	revealButton.size="large";
  	revealButton.onclick = function (){
	  kamigawaCards.find(cardRevealed => cardRevealed.id == card.id).status = "Shown"
  	  drawTables();
	};
	revealButton.setAttribute('style','height:50px;width:100px;');
	
	var libraryButton = document.createElement('button');
  	libraryButton.data =  "Library";
  	libraryButton.innerHTML = "Library";
	libraryButton.size="large";
  	libraryButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Library"
  	  drawTables();
	};
	libraryButton.setAttribute('style','height:50px;width:100px;');
	
	var handButton = document.createElement('button');
  	handButton.data =  "Hand";
  	handButton.innerHTML = "Hand";
	handButton.size="large";
  	handButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Hand"
  	  drawTables();
	};
	handButton.setAttribute('style','height:50px;width:100px;');
	
	var battlefieldButton = document.createElement('button');
  	battlefieldButton.data =  "Battlefield";
  	battlefieldButton.innerHTML = "Battlefield";
	battlefieldButton.size="large";
  	battlefieldButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Battlefield"
  	  drawTables();
	};
	battlefieldButton.setAttribute('style','height:50px;width:100px;');
	
	var graveyardButton = document.createElement('button');
  	graveyardButton.data =  "Graveyard";
  	graveyardButton.innerHTML = "Graveyard";
	graveyardButton.size="large";
  	graveyardButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Graveyard"
  	  drawTables();
	};
	graveyardButton.setAttribute('style','height:50px;width:100px;');
	
	var exileButton = document.createElement('button');
  	exileButton.data =  "Exile";
  	exileButton.innerHTML = "Exile";
	exileButton.size="large";
  	exileButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Exile"
  	  drawTables();
	};
	exileButton.setAttribute('style','height:50px;width:100px;');
	
	var showBackButton = document.createElement('button');
  	showBackButton.data =  "Show Back";
  	showBackButton.innerHTML = "Show Back";
	showBackButton.size="large";
  	showBackButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "ShownBack"
  	  drawTables();
	};
	showBackButton.setAttribute('style','height:50px;width:100px;');
	
	var showFrontButton = document.createElement('button');
  	showFrontButton.data =  "Show Front";
  	showFrontButton.innerHTML = "Show Front";
	showFrontButton.size="large";
  	showFrontButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "Shown"
  	  drawTables();
	};
	showFrontButton.setAttribute('style','height:50px;width:100px;');
	
	if (card.status == "Hidden") {
	  footerDiv.appendChild(revealButton);
	} else if (card.status == "Shown") {
	  if (card.content.card_faces) {
	   footerDiv.appendChild(showBackButton);
	  } 
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	} else if (card.status == "ShownBack") {
	  footerDiv.appendChild(showFrontButton);
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	}
	 
	
	 headerRow.appendChild(Header);
	 cardRow.appendChild(cardDiv);
	 footerRow.appendChild(footerDiv);
	 
  
	 
     tableBody.appendChild(headerRow);
	 tableBody.appendChild(cardRow);
	 tableBody.appendChild(footerRow);

 
	 if (table.tBodies[0]) {
	  table.replaceChild(tableBody, table.tBodies[0]);
	 } else {
	  table.appendChild(tableBody);
	 }
  });
  if (cards.filter(card => (card.status != "Gone")).length == 0) {
    table.replaceChild(tableBody, table.tBodies[0]);
  }
  
}

function drawLibraryTable()
{
  var table = document.getElementById('libraryTable');
  var tableBody = document.createElement('tbody');
  table.appendChild(tableBody);
  
  kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Library")).forEach(function(card, i) {
	var headerRow
	var cardRow
	if (i % 5 == 0) {
	  headerRow = document.createElement('tr');
	  cardRow = document.createElement('tr');
	  footerRow = document.createElement('tr');
	} else {
	  headerRow = table.rows[Math.floor(i/5)*3]
	  cardRow = table.rows[Math.floor(i/5)*3 + 1]
	  footerRow = table.rows[Math.floor(i/5)*3 + 2]
	}
	 var Header = document.createElement("th");
     Header.textContent =  "Library: " + card.id;
	 
	  var cardDiv = document.createElement('td');
	 var cardImage = document.createElement('img');
	 
	 var cardImageLink
	 if (isDoubleFace(card)) {
	   if (card.status == "ShownBack") {
	    cardImageLink = card.content.card_faces[1].image_uris.normal;
	   } else {
	    cardImageLink = card.content.card_faces[0].image_uris.normal;
		}
	 } else {
	   cardImageLink = card.content.image_uris.normal;
	 }
	 
	 cardImage.src =  (card.status == "Hidden") ? cardBackImage : cardImageLink;
	 cardImage.width = 300;
	 cardImage.height = 450;
	 cardDiv.appendChild(cardImage);
	 
	 var footerDiv = document.createElement('td');
	 footerDiv.setAttribute('style','text-align :center;');
	var revealButton = document.createElement('button');
  	revealButton.data =  "Reveal";
  	revealButton.innerHTML = "Reveal";
	revealButton.size="large";
  	revealButton.onclick = function (){
	  kamigawaCards.find(cardRevealed => cardRevealed.id == card.id).status = "Shown"
  	  drawTables();
	};
	revealButton.setAttribute('style','height:50px;width:100px;');
	
	var libraryButton = document.createElement('button');
  	libraryButton.data =  "Library";
  	libraryButton.innerHTML = "Library";
	libraryButton.size="large";
  	libraryButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Library"
  	  drawTables();
	};
	libraryButton.setAttribute('style','height:50px;width:100px;');
	
	var handButton = document.createElement('button');
  	handButton.data =  "Hand";
  	handButton.innerHTML = "Hand";
	handButton.size="large";
  	handButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Hand"
  	  drawTables();
	};
	handButton.setAttribute('style','height:50px;width:100px;');
	
	var battlefieldButton = document.createElement('button');
  	battlefieldButton.data =  "Battlefield";
  	battlefieldButton.innerHTML = "Battlefield";
	battlefieldButton.size="large";
  	battlefieldButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Battlefield"
  	  drawTables();
	};
	battlefieldButton.setAttribute('style','height:50px;width:100px;');
	
	var graveyardButton = document.createElement('button');
  	graveyardButton.data =  "Graveyard";
  	graveyardButton.innerHTML = "Graveyard";
	graveyardButton.size="large";
  	graveyardButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Graveyard"
  	  drawTables();
	};
	graveyardButton.setAttribute('style','height:50px;width:100px;');
	
	var exileButton = document.createElement('button');
  	exileButton.data =  "Exile";
  	exileButton.innerHTML = "Exile";
	exileButton.size="large";
  	exileButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Exile"
  	  drawTables();
	};
	exileButton.setAttribute('style','height:50px;width:100px;');
	
	var showBackButton = document.createElement('button');
  	showBackButton.data =  "Show Back";
  	showBackButton.innerHTML = "Show Back";
	showBackButton.size="large";
  	showBackButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "ShownBack"
  	  drawTables();
	};
	showBackButton.setAttribute('style','height:50px;width:100px;');
	
	var showFrontButton = document.createElement('button');
  	showFrontButton.data =  "Show Front";
  	showFrontButton.innerHTML = "Show Front";
	showFrontButton.size="large";
  	showFrontButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "Shown"
  	  drawTables();
	};
	showFrontButton.setAttribute('style','height:50px;width:100px;');
	
	if (card.status == "Hidden") {
	  footerDiv.appendChild(revealButton);
	} else if (card.status == "Shown") {
	  if (card.content.card_faces) {
	   footerDiv.appendChild(showBackButton);
	  } 
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	} else if (card.status == "ShownBack") {
	  footerDiv.appendChild(showFrontButton);
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	}
	 
	
	 headerRow.appendChild(Header);
	 cardRow.appendChild(cardDiv);
	 footerRow.appendChild(footerDiv);
	 
  
	 
     tableBody.appendChild(headerRow);
	 tableBody.appendChild(cardRow);
	 tableBody.appendChild(footerRow);

 
	 if (table.tBodies[0]) {
	  table.replaceChild(tableBody, table.tBodies[0]);
	 } else {
	  table.appendChild(tableBody);
	 }
  });
  if (cards.filter(card => (card.status != "Gone")).length == 0) {
    table.replaceChild(tableBody, table.tBodies[0]);
  }
  
}

function drawExileTable()
{
  var table = document.getElementById('exileTable');
  var tableBody = document.createElement('tbody');
  table.appendChild(tableBody);
  
  kamigawaCards.filter(card => (card.status != "Gone" && card.zone == "Exile")).forEach(function(card, i) {
	var headerRow
	var cardRow
	if (i % 5 == 0) {
	  headerRow = document.createElement('tr');
	  cardRow = document.createElement('tr');
	  footerRow = document.createElement('tr');
	} else {
	  headerRow = table.rows[Math.floor(i/5)*3]
	  cardRow = table.rows[Math.floor(i/5)*3 + 1]
	  footerRow = table.rows[Math.floor(i/5)*3 + 2]
	}
	 var Header = document.createElement("th");
     Header.textContent =  "Exile: " + card.id;
	 
	  var cardDiv = document.createElement('td');
	 var cardImage = document.createElement('img');
	 
	 var cardImageLink
	 if (isDoubleFace(card)) {
	   if (card.status == "ShownBack") {
	    cardImageLink = card.content.card_faces[1].image_uris.normal;
	   } else {
	    cardImageLink = card.content.card_faces[0].image_uris.normal;
		}
	 } else {
	   cardImageLink = card.content.image_uris.normal;
	 }
	 
	 cardImage.src =  (card.status == "Hidden") ? cardBackImage : cardImageLink;
	 cardImage.width = 300;
	 cardImage.height = 450;
	 cardDiv.appendChild(cardImage);
	 
	 var footerDiv = document.createElement('td');
	 footerDiv.setAttribute('style','text-align :center;');
	var revealButton = document.createElement('button');
  	revealButton.data =  "Reveal";
  	revealButton.innerHTML = "Reveal";
	revealButton.size="large";
  	revealButton.onclick = function (){
	  kamigawaCards.find(cardRevealed => cardRevealed.id == card.id).status = "Shown"
  	  drawTables();
	};
	revealButton.setAttribute('style','height:50px;width:100px;');
	
	var libraryButton = document.createElement('button');
  	libraryButton.data =  "Library";
  	libraryButton.innerHTML = "Library";
	libraryButton.size="large";
  	libraryButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Library"
  	  drawTables();
	};
	libraryButton.setAttribute('style','height:50px;width:100px;');
	
	var handButton = document.createElement('button');
  	handButton.data =  "Hand";
  	handButton.innerHTML = "Hand";
	handButton.size="large";
  	handButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Hand"
  	  drawTables();
	};
	handButton.setAttribute('style','height:50px;width:100px;');
	
	var battlefieldButton = document.createElement('button');
  	battlefieldButton.data =  "Battlefield";
  	battlefieldButton.innerHTML = "Battlefield";
	battlefieldButton.size="large";
  	battlefieldButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Battlefield"
  	  drawTables();
	};
	battlefieldButton.setAttribute('style','height:50px;width:100px;');
	
	var graveyardButton = document.createElement('button');
  	graveyardButton.data =  "Graveyard";
  	graveyardButton.innerHTML = "Graveyard";
	graveyardButton.size="large";
  	graveyardButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Graveyard"
  	  drawTables();
	};
	graveyardButton.setAttribute('style','height:50px;width:100px;');
	
	var exileButton = document.createElement('button');
  	exileButton.data =  "Exile";
  	exileButton.innerHTML = "Exile";
	exileButton.size="large";
  	exileButton.onclick = function (){
	  kamigawaCards.find(cardGone => cardGone.id == card.id).zone = "Exile"
  	  drawTables();
	};
	exileButton.setAttribute('style','height:50px;width:100px;');
	
	var showBackButton = document.createElement('button');
  	showBackButton.data =  "Show Back";
  	showBackButton.innerHTML = "Show Back";
	showBackButton.size="large";
  	showBackButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "ShownBack"
  	  drawTables();
	};
	showBackButton.setAttribute('style','height:50px;width:100px;');
	
	var showFrontButton = document.createElement('button');
  	showFrontButton.data =  "Show Front";
  	showFrontButton.innerHTML = "Show Front";
	showFrontButton.size="large";
  	showFrontButton.onclick = function (){
	  kamigawaCards.find(cardShowBack => cardShowBack.id == card.id).status = "Shown"
  	  drawTables();
	};
	showFrontButton.setAttribute('style','height:50px;width:100px;');
	
	if (card.status == "Hidden") {
	  footerDiv.appendChild(revealButton);
	} else if (card.status == "Shown") {
	  if (card.content.card_faces) {
	   footerDiv.appendChild(showBackButton);
	  } 
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	} else if (card.status == "ShownBack") {
	  footerDiv.appendChild(showFrontButton);
	  footerDiv.appendChild(libraryButton);
	  footerDiv.appendChild(handButton);
	  footerDiv.appendChild(battlefieldButton);
	  footerDiv.appendChild(graveyardButton);
	  footerDiv.appendChild(exileButton);
	}
	 
	
	 headerRow.appendChild(Header);
	 cardRow.appendChild(cardDiv);
	 footerRow.appendChild(footerDiv);
	 
  
	 
     tableBody.appendChild(headerRow);
	 tableBody.appendChild(cardRow);
	 tableBody.appendChild(footerRow);

 
	 if (table.tBodies[0]) {
	  table.replaceChild(tableBody, table.tBodies[0]);
	 } else {
	  table.appendChild(tableBody);
	 }
  });
  if (cards.filter(card => (card.status != "Gone")).length == 0) {
    table.replaceChild(tableBody, table.tBodies[0]);
  }
  
}

function drawCommanderTable()
{
  var table = document.getElementById('commanderTable');
  var tableBody = document.createElement('tbody');
  table.appendChild(tableBody);
  commanderCards.filter(card => (card.status != "Gone")).forEach(function(card, i) {
	var headerRow
	var cardRow
	if (i % 5 == 0) {
	  headerRow = document.createElement('tr');
	  cardRow = document.createElement('tr');
	  footerRow = document.createElement('tr');
	} else {
	  headerRow = table.rows[Math.floor(i/5)*3]
	  cardRow = table.rows[Math.floor(i/5)*3 + 1]
	  footerRow = table.rows[Math.floor(i/5)*3 + 2]
	}
	 var Header = document.createElement("th");
     Header.textContent =  card.id;
	 
	var allCardNames = commanderCards.map(obj=>
    obj.content.name);
	 
	var copyButton = document.createElement('button');
  	copyButton.data =  "Copy Deck To Clipboard";
  	copyButton.innerHTML = "Copy Deck To Clipboard";
	copyButton.size="large";
	copyButton.setAttribute('style','height:50px;width:100px;');
  	copyButton.onclick = function (){
	  navigator.clipboard.writeText(allCardNames.join("\n"));
	};
	 
	  var cardDiv = document.createElement('td');
	 var cardImage = document.createElement('img');
	 
	 var cardImageLink
	 if (isDoubleFace(card)) {
	   if (card.status == "ShownBack") {
	    cardImageLink = card.content.card_faces[1].image_uris.normal;
	   } else {
	    cardImageLink = card.content.card_faces[0].image_uris.normal;
		}
	 } else {
	   cardImageLink = card.content.image_uris.normal;
	 }
	 
	 cardImage.src =  (card.status == "Hidden") ? cardBackImage : cardImageLink;
	 cardImage.width = 300;
	 cardImage.height = 450;
	 cardDiv.appendChild(cardImage);
	 
	 var footerDiv = document.createElement('td');
	 footerDiv.setAttribute('style','text-align :center;');
	var revealButton = document.createElement('button');
  	revealButton.data =  "Reveal";
  	revealButton.innerHTML = "Reveal";
	revealButton.size="large";
  	revealButton.onclick = function (){
	  commanderCards.find(cardRevealed => cardRevealed.id == card.id).status = "Shown"
  	  drawTables();
	};
	revealButton.setAttribute('style','height:50px;width:100px;');
	
	var showBackButton = document.createElement('button');
  	showBackButton.data =  "Show Back";
  	showBackButton.innerHTML = "Show Back";
	showBackButton.size="large";
  	showBackButton.onclick = function (){
	  commanderCards.find(cardShowBack => cardShowBack.id == card.id).status = "ShownBack"
  	  drawTables();
	};
	showBackButton.setAttribute('style','height:50px;width:100px;');
	
	var showFrontButton = document.createElement('button');
  	showFrontButton.data =  "Show Front";
  	showFrontButton.innerHTML = "Show Front";
	showFrontButton.size="large";
  	showFrontButton.onclick = function (){
	  commanderCards.find(cardShowBack => cardShowBack.id == card.id).status = "Shown"
  	  drawTables();
	};
	showFrontButton.setAttribute('style','height:50px;width:100px;');
	
	var rerollButton = document.createElement('button');
  	rerollButton.data =  "Reroll";
  	rerollButton.innerHTML = "Reroll";
	rerollButton.size="large";
  	rerollButton.onclick = async function (){
	  cardfound = false
	  while(!cardfound) { 
		  rerollResponse = await fetch('https://api.scryfall.com/cards/random?q=' + card.reroll);
		  const rerollContent = await rerollResponse.json(); 
		  let rerollCard = {content: rerollContent, status: "Shown", id: card.id, reroll: card.reroll}
		  if (!(commanderCards.find(existingCard => (existingCard.content.name == rerollCard.content.name))) || rerollCard.content.type_line.includes("Basic")) {
		    cardfound = true;
			commanderCards[card.id] = rerollCard;
		  }
       }		  
	  drawTables();
	};
	rerollButton.setAttribute('style','height:50px;width:100px;');
	
	if (card.reroll != "") {
	  footerDiv.appendChild(rerollButton);
	}
	
	if (card.status == "Hidden") {
	  footerDiv.appendChild(revealButton);
	} else if (card.status == "Shown") {
	  if (card.content.card_faces) {
	   footerDiv.appendChild(showBackButton);
	  } 
	} else if (card.status == "ShownBack") {
	  footerDiv.appendChild(showFrontButton);
	}
	
	if (card.id == 0){
	  footerDiv.appendChild(copyButton);
	}
	 
	
	 headerRow.appendChild(Header);
	 cardRow.appendChild(cardDiv);
	 footerRow.appendChild(footerDiv);
	 
  
	 
     tableBody.appendChild(headerRow);
	 tableBody.appendChild(cardRow);
	 tableBody.appendChild(footerRow);

 
	 if (table.tBodies[0]) {
	  table.replaceChild(tableBody, table.tBodies[0]);
	 } else {
	  table.appendChild(tableBody);
	 }
  });
  if (cards.filter(card => (card.status != "Gone")).length == 0) {
    table.replaceChild(tableBody, table.tBodies[0]);
  }
  
}

document.getElementById("cardButton").onclick=async() => {
  const response = await fetch('https://api.scryfall.com/cards/random?q=-t:land');
  const cardContent = await response.json(); //extract JSON from the http response
  let card = {content: cardContent, status: "Hidden", id: cardId}
  cardId += 1;
  cards.push(card);
  drawTables();
};

document.getElementById("kamigawaButton").onclick=async() => {
  let pack = []
  let includesFoil = Math.floor(Math.random() * 3) == 2;
  while (pack.length < 1) {
	  const response = await fetch('https://api.scryfall.com/cards/random?q=(e:neo or e:sok or e:bok or e:chk)rarity>=rare');
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
	  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
		  kamigawaCardId += 1;
		  pack.push(card);
	  }
   }
  while (pack.length < 4) {
	  const response = await fetch('https://api.scryfall.com/cards/random?q=(e:neo or e:sok or e:bok or e:chk)rarity=uncommon');
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
	  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
		  kamigawaCardId += 1;
		  pack.push(card);
	  }
   }
  while (pack.length < 5) {
	  const response = await fetch('https://api.scryfall.com/cards/random?q=-t:land(e:neo or e:sok or e:bok or e:chk)rarity=common c:w');
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
	  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
		  kamigawaCardId += 1;
		  pack.push(card);
	  }
   }
  while (pack.length < 6) {
	  const response = await fetch('https://api.scryfall.com/cards/random?q=-t:land(e:neo or e:sok or e:bok or e:chk)rarity=common c:u');
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
	  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
		  kamigawaCardId += 1;
		  pack.push(card);
	  }
   }
  while (pack.length < 7) {
	  const response = await fetch('https://api.scryfall.com/cards/random?q=-t:land(e:neo or e:sok or e:bok or e:chk)rarity=common c:b');
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
	  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
		  kamigawaCardId += 1;
		  pack.push(card);
	  }
   }
  while (pack.length < 8) {
	  const response = await fetch('https://api.scryfall.com/cards/random?q=-t:land(e:neo or e:sok or e:bok or e:chk)rarity=common c:r');
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
	  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
		  kamigawaCardId += 1;
		  pack.push(card);
	  }
   }
  while (pack.length < 9) {
	  const response = await fetch('https://api.scryfall.com/cards/random?q=-t:land(e:neo or e:sok or e:bok or e:chk)rarity=common c:g');
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
	  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
		  kamigawaCardId += 1;
		  pack.push(card);
	  }
   }
  while (pack.length < 13) {
	  const response = await fetch('https://api.scryfall.com/cards/random?q=-t:land(e:neo or e:sok or e:bok or e:chk)rarity=common');
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
	  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
		  kamigawaCardId += 1;
		  pack.push(card);
	  }
   }
  if (includesFoil) {
	  while (pack.length < 14) {
		  const response = await fetch('https://api.scryfall.com/cards/random?q=-t:land(e:neo or e:sok or e:bok or e:chk)is:foil');
		  const cardContent = await response.json(); //extract JSON from the http response
		  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
		  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
			  kamigawaCardId += 1;
			  pack.push(card);
		  }
	   }
  } else {  
	  while (pack.length < 14) {
		  const response = await fetch('https://api.scryfall.com/cards/random?q=-t:land(e:neo or e:sok or e:bok or e:chk)rarity=common');
		  const cardContent = await response.json(); //extract JSON from the http response
		  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
		  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
			  kamigawaCardId += 1;
			  pack.push(card);
		  }
	   }
   }	    
  while (pack.length < 15) {
	  const response = await fetch('https://api.scryfall.com/cards/random?q=t:land(e:neo or e:sok or e:bok or e:chk)rarity=common');
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Hidden", id: kamigawaCardId, zone: "Booster"}
	  if (pack.filter(packCard => (packCard.content.name == card.content.name)).length == 0) {
		  kamigawaCardId += 1;
		  pack.push(card);
	  }
   }
  pack.forEach(function(card) {  
	kamigawaCards.push(card);
  });
  drawTables();
};

document.getElementById("commanderButton").onclick=async() => {
  commanderCards.length = 0;
  cardId = 0;
  document.getElementById("commanderButton").disabled = true;
  const commanderResponse = await fetch('https://api.scryfall.com/cards/random?q=is:commander c:wubrg -t:background');
  const commanderContent = await commanderResponse.json(); //extract JSON from the http response
  let commander = {content: commanderContent, status: "Shown", id: cardId, reroll: ""}
  cardId += 1;
  commanderCards.push(commander);
  drawTables();
  colorIdentity = "c";
  colorIdentity2 = "";
  totalColorIdentity = "c";
  if (commander.content.color_identity.length > 0) {
   colorIdentity = commander.content.color_identity.join("");
   totalColorIdentity = colorIdentity;
  }
  synergyResponse = await fetch('https://json.edhrec.com/pages/commanders/' + commander.content.scryfall_uri.split("/")[commander.content.scryfall_uri.split("/").length -1].split("?")[0] + '.json');
  const synergyContent = await synergyResponse.json();
  synergyCards = [];
  if (synergyContent.hasOwnProperty("container")){
	  synergyObject = synergyContent.container.json_dict.cardlists.find(cardList => (cardList.tag == "highsynergycards"));
	  if (synergyObject && synergyObject.hasOwnProperty("cardviews")){
		synergyCards = synergyCards.concat(synergyObject["cardviews"]);
       }
  }
  if (commander.content.keywords.includes("Partner") && ! commander.content.keywords.includes("Partner with")) {
	 colorIdentity2 = "c";
	 partnerResponse = await fetch('https://api.scryfall.com/cards/random?q=is:commander o:partner -o:"partner with"');
	 const partnerContent = await partnerResponse.json(); 
	 let partner = {content: partnerContent, status: "Shown", id: cardId, reroll: ""}
	  cardId += 1;
	  commanderCards.push(partner);
	  drawTables();
	  if (partner.content.color_identity.length > 0) {
	   colorIdentity2 = partner.content.color_identity.join("")
	   totalColorIdentity = merge(commander.content.color_identity, partner.content.color_identity).join("");
	  }
	  partnerSynergyResponse = await fetch('https://json.edhrec.com/pages/commanders/' + partner.content.scryfall_uri.split("/")[partner.content.scryfall_uri.split("/").length -1].split("?")[0] + '.json');
	  const partnerSynergyContent = await partnerSynergyResponse.json();
	  if (partnerSynergyContent.hasOwnProperty("container")){
		  partnerSynergyObject = partnerSynergyContent.container.json_dict.cardlists.find(cardList => (cardList.tag == "highsynergycards"));
		  if (partnerSynergyObject && partnerSynergyObject.hasOwnProperty("cardviews")){
			synergyCards = synergyCards.concat(partnerSynergyObject["cardviews"]);
		   }
	  }
  } 
  if (commander.content.keywords.includes("Doctor's companion")) {
	 colorIdentity2 = "c";
	 partnerResponse = await fetch('https://api.scryfall.com/cards/random?q=is:commander t:doctor');
	 const partnerContent = await partnerResponse.json(); 
	 let partner = {content: partnerContent, status: "Shown", id: cardId, reroll: ""}
	  cardId += 1;
	  commanderCards.push(partner);
	  drawTables();
	  if (partner.content.color_identity.length > 0) {
	   colorIdentity2 = partner.content.color_identity.join("")
	   totalColorIdentity = merge(commander.content.color_identity, partner.content.color_identity).join("");
	  }
	  partnerSynergyResponse = await fetch('https://json.edhrec.com/pages/commanders/' + partner.content.scryfall_uri.split("/")[partner.content.scryfall_uri.split("/").length -1].split("?")[0] + '.json');
	  const partnerSynergyContent = await partnerSynergyResponse.json();
	  if (partnerSynergyContent.hasOwnProperty("container")){
		  partnerSynergyObject = partnerSynergyContent.container.json_dict.cardlists.find(cardList => (cardList.tag == "highsynergycards"));
		  if (partnerSynergyObject && partnerSynergyObject.hasOwnProperty("cardviews")){
			synergyCards = synergyCards.concat(partnerSynergyObject["cardviews"]);
		   }
	  }
  }
  if (commander.content.keywords.includes("Choose a background")) {
	 colorIdentity2 = "c";
	 partnerResponse = await fetch('https://api.scryfall.com/cards/random?q=is:commander t:background');
	 const partnerContent = await partnerResponse.json(); 
	 let partner = {content: partnerContent, status: "Shown", id: cardId, reroll: ""}
	  cardId += 1;
	  commanderCards.push(partner);
	  drawTables();
	  if (partner.content.color_identity.length > 0) {
	   colorIdentity2 = partner.content.color_identity.join("")
	   totalColorIdentity = merge(commander.content.color_identity, partner.content.color_identity).join("");
	  }
	  partnerSynergyResponse = await fetch('https://json.edhrec.com/pages/commanders/' + partner.content.scryfall_uri.split("/")[partner.content.scryfall_uri.split("/").length -1].split("?")[0] + '.json');
	  const partnerSynergyContent = await partnerSynergyResponse.json();
	  if (partnerSynergyContent.hasOwnProperty("container")){
		  partnerSynergyObject = partnerSynergyContent.container.json_dict.cardlists.find(cardList => (cardList.tag == "highsynergycards"));
		  if (partnerSynergyObject && partnerSynergyObject.hasOwnProperty("cardviews")){
			synergyCards = synergyCards.concat(partnerSynergyObject["cardviews"]);
		   }
	  }
  }
  while (commanderCards.length < 100) {
	  let response;
	  let query = "";
	  if (commanderCards.length < 5 && synergyCards.length > 0) {
	     synergyCardIndex = Math.floor(Math.random()*synergyCards.length)
	     var cardName = synergyCards[synergyCardIndex]["name"];
		 synergyCards.splice(synergyCardIndex, synergyCardIndex);
		 response = await fetch('https://api.scryfall.com/cards/named?exact=' + cardName);
	  }  else if (commanderCards.length < 62) {
	     query = '-t:land -t:attraction -t:stickers f:commander id<=' + totalColorIdentity
		 response = await fetch('https://api.scryfall.com/cards/random?q=' + query);
	  } else if (commanderCards.length < 77) {
		  if (totalColorIdentity == "c") {
		   query = 't:basic t:land f:commander id<=' + totalColorIdentity
		   response = await fetch('https://api.scryfall.com/cards/random?q=' + query);
		  } else {
		   query = 't:basic t:land f:commander id>c id<=' + totalColorIdentity
		   response = await fetch('https://api.scryfall.com/cards/random?q=' + query);
		  }
	} else if (commanderCards.length < 92 && totalColorIdentity != "c") {
	   query = 't:land f:commander id>c id<=' + totalColorIdentity
	   response = await fetch('https://api.scryfall.com/cards/random?q=' + query);
	 } else if (commanderCards.length < 93 && totalColorIdentity.length >= 2) {
	   query = 'o:"any color" t:land f:commander id<=' + totalColorIdentity
	   response = await fetch('https://api.scryfall.com/cards/random?q=' + query);
	 } else if (commanderCards.length < 94 && totalColorIdentity.length >= 3) {
	   query = 'o:"any color" t:land f:commander id<=' + totalColorIdentity
	   response = await fetch('https://api.scryfall.com/cards/random?q=' + query);
	 } else if (commanderCards.length < 95 && totalColorIdentity.length >= 4) {
	   query = 'o:"any color" t:land f:commander id<=' + totalColorIdentity
	   response = await fetch('https://api.scryfall.com/cards/random?q=' + query);
	 }  else if (commanderCards.length < 96 && totalColorIdentity.length >= 5) {
	   query = 'o:"any color" t:land f:commander id<=' + totalColorIdentity
	   response = await fetch('https://api.scryfall.com/cards/random?q=' + query);
	 } else {
	  query = 't:land f:commander id<=' + totalColorIdentity
	  response = await fetch('https://api.scryfall.com/cards/random?q=' + query);
	 }
	  const cardContent = await response.json(); //extract JSON from the http response
	  let card = {content: cardContent, status: "Shown", id: cardId, reroll: query}
	  if (!(commanderCards.find(existingCard => (existingCard.content.name == card.content.name))) || card.content.type_line.includes("Basic")) {
		  cardId += 1;
		  commanderCards.push(card);
		  drawTables();
	  }
	  await new Promise(r => setTimeout(r, 100));
  }
  document.getElementById("commanderButton").disabled = false;  
};

document.getElementById("restoreButton").onclicka = function()  {
  cards.filter(card => (card.status == "Gone")).forEach(function(card) {
    card.status = "Shown";
  });
  drawTables();
};

const merge = (a, b, predicate = (a, b) => a === b) => {
    const c = [...a]; // copy to avoid side effects
    // add all items from B to copy C if they're not already present
    b.forEach((bItem) => (c.some((cItem) => predicate(bItem, cItem)) ? null : c.push(bItem)))
    return c;
}



</script>

</body>
</html>
